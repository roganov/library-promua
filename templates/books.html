{% extends '_base.html' %}
{% block content %}
  <div class="">
    <h3>Search by title and author</h3>

    <form class="form-inline">
      <div class="form-group">
        <label class="sr-only" for="title">Book title</label>
        <input type="text" class="form-control" name="title" id="title" placeholder="Book title"
               value="{{ request.args.get('title', '') }}">
      </div>
      <div class="form-group">
        <label class="sr-only" for="name">Author name</label>
        <input type="text" class="form-control" id="name" name="author" placeholder="Author name"
               value="{{ request.args.get('author', '') }}">
      </div>
      <button type="submit" class="btn btn-default">Search</button>
    </form>
  </div>
  <table class="table">
    <caption><h3>Results</h3></caption>
    <thead>
    <tr>
      <th>#</th>
      <th>
        Title
      </th>
      <th>
        Authors
      </th>
    </tr>
    </thead>
    {% for book in books %}
      <tr>
        <td scope="row">
          {{ loop.index }}
        </td>
        <td>
          {% if current_user.can_edit %}
            <a href="{{ url_for('edit_book_view', book_id=book.id) }}">{{ book.title }}</a>
          {% else %}
            {{ book.title }}
          {% endif %}
        </td>
        <td>
          <ul class="list-unstyled">
            {% for author in book.authors %}
              <li>
                {% if current_user.can_edit %}
                  <a href="{{ url_for('edit_book_view', book_id=book.id) }}">{{ author.name }}</a>
                {% else %}
                  {{ author.name }}
                {% endif %}
              </li>
            {% endfor %}
          </ul>
        </td>
      </tr>
    {% endfor %}
  </table>
{% endblock %}